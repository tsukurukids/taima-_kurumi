<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>集中タイマー</title>
    <link rel="manifest" href="./manifest.json">
    <link rel="icon" type="image/png" href="./icon.png">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Chivo+Mono:wght@700&display=swap" rel="stylesheet">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['Chivo Mono', 'monospace'],
                    },
                    colors: {
                        primary: '#6366f1', // Indigo 500
                    }
                }
            }
        }
    </script>

    <!-- Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/tone@14.7.58/build/Tone.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>

    <style>
        body {
            background-color: #ffffff;
            color: #1e293b;
        }

        .timer-digits {
            font-feature-settings: "tnum";
            font-variant-numeric: tabular-nums;
        }

        .btn-hover {
            transition: all 0.2s ease;
        }

        .btn-hover:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .btn-hover:active {
            transform: translateY(0);
        }

        .animate-fade-in {
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body class="flex flex-col items-center justify-center min-h-screen p-4 bg-gray-50">

    <div id="main-card"
        class="w-full max-w-md bg-white p-8 rounded-2xl shadow-xl border border-gray-100 min-h-[500px] transition-colors duration-500">

        <!-- View: Timer -->
        <div id="view-timer"
            class="space-y-8 animate-fade-in flex flex-col items-center justify-center h-full min-h-[400px]">

            <!-- Timer Display -->
            <div class="text-center py-8">
                <div class="timer-digits font-mono text-8xl font-bold text-gray-900 tracking-tight" id="timer-display">
                    00:00
                </div>
            </div>

            <!-- Controls -->
            <div class="flex justify-center items-center space-x-8">
                <!-- Start Button -->
                <button onclick="startTimer()" id="btn-start"
                    class="p-6 rounded-full bg-indigo-600 text-white shadow-lg shadow-indigo-600/20 hover:bg-indigo-700 hover:scale-110 transition-all duration-200">
                    <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24"
                        fill="currentColor">
                        <path d="M8 5v14l11-7z" />
                    </svg>
                </button>

                <!-- Stop/Pause Button -->
                <button onclick="pauseTimer()" id="btn-stop"
                    class="p-6 rounded-full bg-gray-200 text-gray-600 shadow-lg hover:bg-gray-300 hover:scale-110 transition-all duration-200">
                    <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24"
                        fill="currentColor">
                        <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z" />
                    </svg>
                </button>
            </div>

            <!-- Reset Button (Small, optional if user wants only start/stop, but usually needed) -->
            <button onclick="resetTimer()" class="text-gray-300 hover:text-gray-500 transition-colors p-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74-2.74L3 12" />
                </svg>
            </button>
        </div>

        <!-- View: Mode Selection (Hidden) -->
        <div id="view-modes" class="hidden space-y-6 animate-fade-in h-full flex flex-col justify-center py-4">

            <div class="flex flex-col space-y-6">
                <!-- Focus Section -->
                <div class="space-y-3">
                    <!-- Main Focus Button (Lighter & Higher) -->
                    <!-- Focus Header (Non-clickable) -->
                    <div class="flex items-center pl-2 pb-2">
                        <div class="p-2 bg-indigo-100 text-indigo-500 rounded-full mr-3">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"></circle>
                                <circle cx="12" cy="12" r="3"></circle>
                            </svg>
                        </div>
                        <span class="text-xl font-bold text-gray-700">集中</span>
                    </div>

                    <!-- Duration Presets (2x2 Grid) -->
                    <div class="grid grid-cols-2 gap-4">
                        <button onclick="selectTime(10)"
                            class="py-4 bg-white border border-gray-200 rounded-xl text-gray-600 font-bold hover:text-indigo-600 hover:border-indigo-200 hover:bg-indigo-50 transition-all shadow-sm text-lg">
                            10分
                        </button>
                        <button onclick="selectTime(25)"
                            class="py-4 bg-white border border-gray-200 rounded-xl text-gray-600 font-bold hover:text-indigo-600 hover:border-indigo-200 hover:bg-indigo-50 transition-all shadow-sm text-lg">
                            25分
                        </button>
                        <button onclick="selectTime(30)"
                            class="py-4 bg-white border border-gray-200 rounded-xl text-gray-600 font-bold hover:text-indigo-600 hover:border-indigo-200 hover:bg-indigo-50 transition-all shadow-sm text-lg">
                            30分
                        </button>
                        <button onclick="selectTime(60)"
                            class="py-4 bg-white border border-gray-200 rounded-xl text-gray-600 font-bold hover:text-indigo-600 hover:border-indigo-200 hover:bg-indigo-50 transition-all shadow-sm text-lg">
                            60分
                        </button>
                    </div>
                </div>

                <!-- Break Section -->
                <div class="space-y-4">
                    <div class="flex items-center pl-2 pb-2">
                        <div class="p-2 bg-teal-100 text-teal-500 rounded-full mr-3">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path d="M5 12h14"></path>
                                <path d="m12 5 7 7-7 7"></path>
                            </svg>
                        </div>
                        <span class="text-xl font-bold text-gray-700">休憩</span>
                    </div>

                    <div class="grid grid-cols-3 gap-3">
                        <button onclick="selectTime(1, 'shortBreak')"
                            class="py-4 bg-white border border-gray-200 rounded-xl text-gray-600 font-bold hover:text-teal-600 hover:border-teal-200 hover:bg-teal-50 transition-all shadow-sm text-lg">
                            1分
                        </button>
                        <button onclick="selectTime(3, 'shortBreak')"
                            class="py-4 bg-white border border-gray-200 rounded-xl text-gray-600 font-bold hover:text-teal-600 hover:border-teal-200 hover:bg-teal-50 transition-all shadow-sm text-lg">
                            3分
                        </button>
                        <button onclick="selectTime(5, 'shortBreak')"
                            class="py-4 bg-white border border-gray-200 rounded-xl text-gray-600 font-bold hover:text-teal-600 hover:border-teal-200 hover:bg-teal-50 transition-all shadow-sm text-lg">
                            5分
                        </button>
                    </div>
                </div>
            </div>

            <!-- Cancel removed -->
        </div>

        <!-- View: Settings (Hidden) -->
        <div id="view-settings" class="hidden space-y-6 animate-fade-in">
            <h2 class="text-2xl font-bold text-gray-900 mb-6">設定</h2>

            <!-- Notification Settings -->
            <div class="space-y-4">
                <h3 class="text-sm font-semibold text-gray-400 uppercase tracking-wider">通知</h3>
                <div class="flex items-center justify-between p-4 rounded-xl bg-gray-50 cursor-pointer"
                    onclick="toggleNotification()">
                    <div class="flex items-center">
                        <div class="p-2 bg-white rounded-full shadow-sm mr-3 text-indigo-500">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                                <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                            </svg>
                        </div>
                        <span class="font-bold text-gray-700">通知を許可</span>
                    </div>
                    <div id="notification-toggle"
                        class="w-12 h-7 bg-gray-200 rounded-full relative transition-colors duration-300">
                        <div
                            class="absolute left-1 top-1 w-5 h-5 bg-white rounded-full shadow transition-transform duration-300">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Device Color Settings -->
            <div class="space-y-4">
                <h3 class="text-sm font-semibold text-gray-400 uppercase tracking-wider">デバイスの色</h3>
                <div class="grid grid-cols-2 gap-3">
                    <button onclick="changeTheme('indigo')"
                        class="flex items-center p-3 rounded-xl bg-indigo-50 border border-indigo-100 hover:bg-indigo-100 transition-colors">
                        <div class="w-6 h-6 rounded-full bg-indigo-500 mr-3 shadow-sm"></div>
                        <span class="text-sm font-medium text-gray-700">インディゴ</span>
                    </button>
                    <button onclick="changeTheme('pink')"
                        class="flex items-center p-3 rounded-xl bg-pink-50 border border-pink-100 hover:bg-pink-100 transition-colors">
                        <div class="w-6 h-6 rounded-full bg-pink-500 mr-3 shadow-sm"></div>
                        <span class="text-sm font-medium text-gray-700">ピンク</span>
                    </button>
                    <button onclick="changeTheme('teal')"
                        class="flex items-center p-3 rounded-xl bg-teal-50 border border-teal-100 hover:bg-teal-100 transition-colors">
                        <div class="w-6 h-6 rounded-full bg-teal-500 mr-3 shadow-sm"></div>
                        <span class="text-sm font-medium text-gray-700">ティール</span>
                    </button>
                    <button onclick="changeTheme('dark')"
                        class="flex items-center p-3 rounded-xl bg-gray-100 border border-gray-200 hover:bg-gray-200 transition-colors">
                        <div class="w-6 h-6 rounded-full bg-gray-800 mr-3 shadow-sm"></div>
                        <span class="text-sm font-medium text-gray-700">ダーク</span>
                    </button>
                </div>
            </div>

            <div class="pt-8 text-center">
                <button onclick="setView('timer')"
                    class="text-sm text-gray-400 hover:text-gray-600 underline">タイマーに戻る</button>
            </div>
        </div>
    </div>

    <script>
        // --- State ---
        let timerInterval;
        let timeLeft = 25 * 60;
        let isRunning = false;
        let currentMode = 'focus'; // focus, shortBreak, longBreak
        const modes = {
            focus: { time: 25 * 60, message: '集中する時間です' },
            shortBreak: { time: 5 * 60, message: '少し休憩しましょう' },
            longBreak: { time: 15 * 60, message: 'ゆっくり休憩しましょう' }
        };

        // --- Audio with Tone.js ---
        async function initAudio() {
            await Tone.start();
        }

        function playSound(type) {
            if (typeof Tone !== 'undefined') {
                const synth = new Tone.PolySynth(Tone.Synth).toDestination();
                const now = Tone.now();
                try {
                    if (type === 'start') {
                        synth.triggerAttackRelease("C5", "8n", now);
                    } else if (type === 'complete') {
                        synth.triggerAttackRelease(["C5", "E5", "G5", "C6"], "8n", now);
                    }
                } catch (e) {
                    console.log('Audio error', e);
                }
            }
        }

        // --- DOM Elements ---
        const timerDisplay = document.getElementById('timer-display');
        const timerStatus = document.getElementById('timer-status');
        const btnToggle = document.getElementById('btn-toggle');
        const btnStart = document.getElementById('btn-start');
        const btnStop = document.getElementById('btn-stop');

        // --- Timer Logic ---
        function updateDisplay() {
            const absTime = Math.abs(timeLeft);
            const minutes = Math.floor(absTime / 60).toString().padStart(2, '0');
            const seconds = (absTime % 60).toString().padStart(2, '0');
            timerDisplay.textContent = `${minutes}:${seconds}`;
            document.title = `${minutes}:${seconds} - Timer`;

            // Overtime Visuals
            if (timeLeft < 0) {
                timerDisplay.classList.remove('text-gray-900', 'text-white');
                timerDisplay.classList.add('text-red-500');
            } else {
                // Restore default colors based on theme (simplification: remove specific red)
                timerDisplay.classList.remove('text-red-500');
                // Note: Theme implementation re-adds text-gray-900 or text-white, so removing red reveals base class usually.
                // To be safe, we can check basic theme state or just add back base class if missing, 
                // but simpler is to just toggle the 'overtime' class.
                // Let's rely on changeTheme re-applying correct base colors if needed, but for now just remove red.
                // We might need to ensure base color is present.
                if (document.body.style.backgroundColor === 'rgb(15, 23, 42)') { // Dark mode check approx
                    timerDisplay.classList.add('text-white');
                } else {
                    timerDisplay.classList.add('text-gray-900');
                }
            }
        }

        async function startTimer() {
            if (isRunning) return;
            isRunning = true;

            // Visual feedback
            btnStart.classList.add('opacity-50', 'cursor-not-allowed');
            btnStop.classList.remove('opacity-50', 'cursor-not-allowed');

            await Tone.start();
            // playSound('start'); // Sound removed

            timerInterval = setInterval(() => {
                timeLeft--;
                updateDisplay();

                // Optional: Play a sound exactly at 0 if desired, but user said "no sound".
                // We just let it run.
            }, 1000);
        }

        function pauseTimer() {
            if (!isRunning) return;
            clearInterval(timerInterval);
            isRunning = false;
            btnStart.classList.remove('opacity-50', 'cursor-not-allowed');
            btnStop.classList.add('opacity-50', 'cursor-not-allowed');

            // If timer reached overtime (completed goal), save session on stop
            if (timeLeft <= 0) {
                saveSession(originalTime);
                // We don't auto-reset. User sees the final overtime.
                // Session is saved.
            }
        }

        function resetTimer() {
            clearInterval(timerInterval);
            isRunning = false;
            timeLeft = modes[currentMode].time; // Actually we use logic from selectTime usually, but default fallbacks:
            // Since we set timeLeft directly in selectTime, we might need to store 'originalDuration' instead of relying on modes default for custom times.
            // But wait, resetTimer above uses `modes[currentMode].time` or `originalTime`.
            // Let's fix resetTimer to use `originalTime` which we update in selectTime.
            timeLeft = originalTime;

            updateDisplay();

            // Reset styles
            timerDisplay.classList.remove('text-red-500');
            if (document.body.style.backgroundColor === 'rgb(15, 23, 42)') {
                timerDisplay.classList.add('text-white');
            } else {
                timerDisplay.classList.add('text-gray-900');
            }

            btnStart.classList.remove('opacity-50', 'cursor-not-allowed');
            btnStop.classList.remove('opacity-50', 'cursor-not-allowed');
        }

        function setMode(mode) {
            pauseTimer();
            currentMode = mode;
            timeLeft = modes[mode].time;
            originalTime = timeLeft; // Update originalTime when mode changes
            updateDisplay();
            btnStart.classList.remove('opacity-50', 'cursor-not-allowed');
            btnStop.classList.remove('opacity-50', 'cursor-not-allowed');
        }

        // --- Stats & Chart.js ---
        function saveSession(seconds) {
            const today = new Date().toDateString();
            let stats = JSON.parse(localStorage.getItem('timerStats')) || {};

            if (!stats[today]) {
                stats[today] = { count: 0, minutes: 0 };
            }

            stats[today].count += 1;
            stats[today].minutes += Math.floor(seconds / 60);

            localStorage.setItem('timerStats', JSON.stringify(stats));
        }

        // --- Service Worker ---
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js');
            });
        }

        // --- Init ---
        // updateDisplay(); // Don't show default time on load
        setView('modes'); // Start on mode selection screen by default

    </script>

    <!-- Bottom Left Timer Menu: Removed (Replaced by View) -->


    <!-- Trigger Icons Container -->
    <div
        class="flex items-center space-x-8 bg-white/80 backdrop-blur-sm p-4 rounded-full shadow-sm border border-gray-100/50">
        <!-- Mode (Timer) Trigger -->
        <div onclick="handleClickTimer()"
            class="flex flex-col items-center space-y-2 text-indigo-600 cursor-pointer hover:text-indigo-800 transition-colors group relative w-16">
            <div
                class="p-4 bg-white rounded-full shadow-md border border-indigo-100 group-hover:scale-110 transition-transform ring-4 ring-indigo-50/50">
                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
            </div>
            <span class="text-xs font-bold tracking-wide text-gray-500 group-hover:text-indigo-600">タイマー</span>
        </div>

        <!-- Record (History) Trigger (Non-functional placeholder for now) -->
        <div onclick="alert('記録機能は準備中です')"
            class="flex flex-col items-center space-y-2 text-gray-400 cursor-pointer hover:text-indigo-600 transition-colors group w-16">
            <div
                class="p-4 bg-white rounded-full shadow-md border border-gray-100 group-hover:border-indigo-100 group-hover:scale-110 transition-transform">
                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <line x1="16" y1="13" x2="8" y2="13"></line>
                    <line x1="16" y1="17" x2="8" y2="17"></line>
                    <polyline points="10 9 9 9 8 9"></polyline>
                </svg>
            </div>
            <span class="text-xs font-bold tracking-wide text-gray-500 group-hover:text-indigo-600">記録</span>
        </div>

        <!-- Settings Trigger -->
        <div onclick="setView('settings')"
            class="flex flex-col items-center space-y-2 text-gray-400 cursor-pointer hover:text-indigo-600 transition-colors group w-16">
            <div
                class="p-4 bg-white rounded-full shadow-md border border-gray-100 group-hover:border-indigo-100 group-hover:scale-110 transition-transform">
                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="3"></circle>
                    <path
                        d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                    </path>
                </svg>
            </div>
            <span class="text-xs font-bold tracking-wide text-gray-500 group-hover:text-indigo-600">設定</span>
        </div>
    </div>
    </div>

    <script>
        // --- View Navigation ---
        let currentView = 'timer';

        function setView(view) {
            currentView = view;
            const timerView = document.getElementById('view-timer');
            const settingsView = document.getElementById('view-settings');
            const modesView = document.getElementById('view-modes');

            // Hide all
            timerView.classList.add('hidden');
            settingsView.classList.add('hidden');
            modesView.classList.add('hidden');

            if (view === 'timer') {
                timerView.classList.remove('hidden');
            } else if (view === 'settings') {
                settingsView.classList.remove('hidden');
            } else if (view === 'modes') {
                modesView.classList.remove('hidden');
            }
        }

        function handleClickTimer() {
            // Updated: Always go to Timer View, do NOT toggle modes
            setView('view-modes'); // Previously 'view-modes' was hidden, but user requested layout changes implies this IS the main view or at least accessible.
            // Wait, User said "タイマーのぼたんをおしたらモードが変わるのはやめて" -> "Stop changing modes when pressing the timer button".
            // "２５分のタイマーが表示されないようにしてください" -> "Don't display the 25 min timer".
            // "押してもモードが変更されないようにしてください" -> "Don't change mode when pressed".

            // Interpretation: The Timer Icon at the bottom left should probably just GO to the main screen, but NOT toggle between 'Timer View' and 'Selection View' automatically like a toggle switch.
            // OR: It should just do nothing if already there?
            // "Don't show the 25 min timer" -> Default state should be 00:00 or empty.

            // Let's set it to go to 'view-modes' (the selection screen) because that's where the user picks 10/30/60.
            // The "Timer View" with 00:00 is useless unless a time is picked.
            // So the 'Home' screen is effectively 'view-modes'.

            setView('modes');
        }

        function selectMode(mode) {
            setMode(mode);
            setView('timer');
        }

        function selectTime(minutes, mode = 'focus') {
            currentMode = mode;
            timeLeft = minutes * 60;
            originalTime = timeLeft;
            updateDisplay();

            // Set styling based on mode (Optional: update theme color?)
            if (mode === 'shortBreak') {
                // Could call changeTheme to teal if desired, but user didn't explicitly ask to switch themes automatically
                changeTheme('teal');
            } else {
                changeTheme('indigo');
            }

            // Allow controls
            const btnStart = document.getElementById('btn-start');
            const btnStop = document.getElementById('btn-stop');
            btnStart.classList.remove('opacity-50', 'cursor-not-allowed');
            btnStop.classList.remove('opacity-50', 'cursor-not-allowed');

            setView('timer');
        }

        /* toggleTimerMenu removed */

        // --- Settings Logic ---
        let notificationsEnabled = false;
        function toggleNotification() {
            notificationsEnabled = !notificationsEnabled;
            // Visual Toggle
            const toggleBg = document.getElementById('notification-toggle');
            const toggleDot = toggleBg.querySelector('div');

            if (notificationsEnabled) {
                toggleBg.classList.replace('bg-gray-200', 'bg-indigo-500');
                toggleDot.classList.add('translate-x-6'); // Adjusted for larger toggle
                if ("Notification" in window) Notification.requestPermission();
            } else {
                toggleBg.classList.replace('bg-indigo-500', 'bg-gray-200');
                toggleDot.classList.remove('translate-x-6');
            }
        }

        function changeTheme(theme) {
            const mainCard = document.getElementById('main-card');
            const timerDisplay = document.getElementById('timer-display');
            const timerStatus = document.getElementById('timer-status');
            const btnToggle = document.getElementById('btn-toggle');

            // Reset base styles
            document.body.className = "flex flex-col items-center justify-center min-h-screen p-4 transition-colors duration-500";

            if (theme === 'dark') {
                document.body.style.backgroundColor = '#0f172a';
                mainCard.className = "w-full max-w-md bg-slate-900 border border-slate-800 p-8 rounded-2xl shadow-xl min-h-[500px] transition-colors duration-500";

                // Text colors
                document.querySelector('#view-timer h1').className = "text-2xl font-bold text-white";
                document.querySelector('#view-timer p.text-sm').className = "text-slate-400 text-sm";
                document.querySelector('#view-settings h2').className = "text-2xl font-bold text-white mb-6"; // Settings H2
                document.querySelector('#view-settings h3').className = "text-sm font-semibold text-slate-400 uppercase tracking-wider"; // Settings H3
                document.querySelector('#view-settings .font-bold').className = "font-bold text-white"; // Notification text
                document.querySelector('#view-settings .underline').className = "text-sm text-slate-400 hover:text-slate-200 underline"; // Back to timer link

                timerDisplay.className = "timer-digits font-mono text-7xl font-bold text-white tracking-tight";
            } else {
                document.body.style.backgroundColor = '#f9fafb';
                mainCard.className = "w-full max-w-md bg-white border border-gray-100 p-8 rounded-2xl shadow-xl min-h-[500px] transition-colors duration-500";

                document.querySelector('#view-timer h1').className = "text-2xl font-bold text-gray-900";
                document.querySelector('#view-timer p.text-sm').className = "text-gray-500 text-sm";
                document.querySelector('#view-settings h2').className = "text-2xl font-bold text-gray-900 mb-6";
                document.querySelector('#view-settings h3').className = "text-sm font-semibold text-gray-400 uppercase tracking-wider";
                document.querySelector('#view-settings .font-bold').className = "font-bold text-gray-700";
                document.querySelector('#view-settings .underline').className = "text-sm text-gray-400 hover:text-gray-600 underline";

                timerDisplay.className = "timer-digits font-mono text-7xl font-bold text-gray-900 tracking-tight";
            }

            // Accent Colors
            if (theme === 'pink') {
                timerStatus.className = "mt-2 text-pink-500 font-medium";
                btnToggle.className = "btn-hover p-6 rounded-full bg-pink-500 text-white shadow-lg shadow-pink-500/20";
            } else if (theme === 'teal') {
                timerStatus.className = "mt-2 text-teal-500 font-medium";
                btnToggle.className = "btn-hover p-6 rounded-full bg-teal-500 text-white shadow-lg shadow-teal-500/20";
            } else {
                // Indigo (Default/Dark)
                timerStatus.className = "mt-2 text-indigo-500 font-medium";
                btnToggle.className = "btn-hover p-6 rounded-full bg-indigo-600 text-white shadow-lg shadow-indigo-600/20";
            }
        }
    </script>
</body>

</html>